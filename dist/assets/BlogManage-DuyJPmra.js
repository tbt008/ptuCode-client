import{k as O,s as i,D as Z,r as d,o as I,c as z,e,w as n,x as b,b as o,F as ee,a as u,M as F,E as k,L as te,_ as ae,h as m,t as oe,y as le,N as ne,z as se,A as ce,O as U,P as q,Q as ie}from"./index-DdujhLSS.js";const de=["src"],re=O({__name:"PictureManage",setup(R){const f=i([]),C=i(""),y=i(!1),P=r=>{C.value=r.url,y.value=!0},g=async()=>{u.get("https://www.tbt-blog.cn/tbt/file/getPicture").then(r=>{if(r.data.code===1){const v=r.data.data;for(var c=[],p=0;p<v.length;p++)c.push({name:v[p].id,url:v[p].src});f.value=c}else console.error("Failed to fetch pictures:",r.data.message)})},T=(r,c)=>{F.confirm("确定要删除这张照片吗？","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{w(r.url)}).catch(()=>{g()})},w=async r=>{try{var c=new FormData;c.append("fileKey",r);const p=await u.post("https://www.tbt-blog.cn/tbt/file/deleFile",c);k.info(p.data)}catch(p){console.error("Error deleting picture:",p),k.error("删除失败，请稍后重试")}};return Z(()=>{g()}),(r,c)=>{const p=d("el-icon"),v=d("el-upload"),A=d("el-dialog");return I(),z(ee,null,[e(v,{"file-list":f.value,"onUpdate:fileList":c[0]||(c[0]=$=>f.value=$),action:"https://www.tbt-blog.cn/tbt/file/addPhotoFile","list-type":"picture-card","on-preview":P,"on-remove":T},{default:n(()=>[e(p,null,{default:n(()=>[e(b(te))]),_:1})]),_:1},8,["file-list"]),e(A,{modelValue:y.value,"onUpdate:modelValue":c[1]||(c[1]=$=>y.value=$),class:"custom-dialog"},{default:n(()=>[o("img",{class:"preview-image",src:C.value,alt:"Preview Image"},null,8,de)]),_:1},8,["modelValue"])],64)}}}),pe=ae(re,[["__scopeId","data-v-60fc97af"]]),ue={class:"manage-body"},_e={id:"main"},be={id:"click-section"},me={id:"drawerboxes"},fe={class:"drawerbox active"},ge=o("span",{class:"drawer-head"},"1",-1),we={class:"drawerbox"},ve=o("span",{class:"drawer-head"},"2",-1),he={class:"drawerbox"},ye=o("span",{class:"drawer-head"},"3",-1),xe={class:"drawerbox"},ke=o("span",{class:"drawer-head"},"4",-1),Ce={id:"slide-section"},Te=o("div",{id:"slide-bar"},[o("div",{id:"bar"})],-1),$e={id:"card-section"},Be={id:"card1",class:"manage-card"},De={class:"BlogManage"},Pe={id:"card2",class:"manage-card"},Ae={class:"TypeManage"},Fe={id:"card3",class:"manage-card"},Me={id:"card4",class:"manage-card"},Ve=o("div",{class:"el-upload__text"},[m("Drop file here or "),o("em",null,"click to upload")],-1),Le=O({__name:"BlogManage",setup(R){const f=ce();i({cate_id:"",state:""}),i(1);var C=i(""),y=i(""),P=i(""),g=i("");const T=i(""),w=()=>{c()};function r(){const l=new FormData;l.append("content",g.value),u.post("https://www.tbt-blog.cn/tbt/essay/add",l)}const c=()=>{F.prompt("请输入管理员密码","Tip",{confirmButtonText:"确定",cancelButtonText:"取消",inputErrorMessage:"请输入管理员密码"}).then(({value:l})=>{var t=new FormData;t.append("password",l),u.post("https://www.tbt-blog.cn/tbt/check/admin",t).then(a=>{if(a.data.code=="0"){k.error(a.data.data),f.back();return}else k.success(a.data.data)}),u.get("https://www.tbt-blog.cn/tbt/article/page?pageNo=1&pageSize=100&isAsc=false").then(a=>{C.value=a.data.data}),u.get("https://www.tbt-blog.cn/tbt/type/page?pageNo=1&pageSize=10&isAsc=false").then(a=>{y.value=a.data.data}),u.get("https://www.tbt-blog.cn/tbt/message/getAll").then(a=>{P.value=a.data.data})}).catch(()=>{f.back()})};w();function p(){f.push({path:"/editor"})}function v(){u.post(`https://www.tbt-blog.cn/tbt/type/add?name=${T.value}`).then(l=>{w()})}function A(l){f.push({path:"/editor",query:{id:l.id}})}function $(l){const t=l.id;u.post(`https://www.tbt-blog.cn/tbt/article/delete/${t}`).then(a=>{w()})}function K(l){const t=l.id;u.post(`https://www.tbt-blog.cn/tbt/type/delete/${t}`).then(a=>{w()})}function Y(l){const t=l.id;F.prompt("Please input your type","Tip",{confirmButtonText:"OK",cancelButtonText:"Cancel"}).then(({value:a})=>{k({type:"success",message:`成功修改为:${a}`});const h=new FormData;h.append("id",t),h.append("name",a),u.post("https://www.tbt-blog.cn/tbt/type/update",h).then(_=>{w()})}).catch(()=>{k({type:"info",message:"Input canceled"})})}function H(l){const t=l.id;u.post(`https://www.tbt-blog.cn/tbt/article/hide/${t}`).then(()=>{w()})}function Q(l){let t=x.value;const a=document.querySelectorAll(".drawerbox");a[t-1].classList.toggle("active"),a[l-1].classList.toggle("active")}const x=i(1),M=i(0),V=i(0);function B(l){Q(l),j(l);let t=x.value;x.value=l,M.value+=(x.value-t)*-100,V.value+=(x.value-t)*100,G(V.value);const a=document.querySelectorAll(".manage-card");Array.from(a).forEach(h=>{h.style.transform=`translateY(${M.value}%)`})}function j(l){let t=x.value;const a=document.querySelectorAll(".drawer-btn");a[t-1].classList.toggle("active"),a[l-1].classList.toggle("active")}function G(l){const t=document.querySelector("#bar");t.style.transform=`translateY(${l}%)`}return(l,t)=>{const a=d("el-button"),h=d("el-link"),_=d("el-table-column"),J=d("TurnOff"),E=d("el-icon"),L=d("el-empty"),S=d("el-table"),N=d("el-scrollbar"),W=d("el-input"),X=d("el-upload");return I(),z("div",ue,[o("div",_e,[o("div",be,[o("div",me,[o("div",fe,[o("button",{class:"drawer-btn active",onClick:t[0]||(t[0]=s=>B(1))},[m(" 文章管理"),ge])]),o("div",we,[o("button",{class:"drawer-btn",onClick:t[1]||(t[1]=s=>B(2))},[m(" 分类管理"),ve])]),o("div",he,[o("button",{class:"drawer-btn",onClick:t[2]||(t[2]=s=>B(3))},[m(" 图片管理"),ye])]),o("div",xe,[o("button",{class:"drawer-btn",onClick:t[3]||(t[3]=s=>B(4))},[m(" 留言管理"),ke])])])]),o("div",Ce,[Te,o("div",$e,[o("div",Be,[o("div",De,[e(a,{type:"primary",onClick:p},{default:n(()=>[m("发布文章")]),_:1}),e(N,{height:"600px"},{default:n(()=>[e(S,{data:b(C),style:{width:"100%"}},{empty:n(()=>[e(L,{description:"没有数据"})]),default:n(()=>[e(_,{label:"文章标题",width:"200"},{default:n(({row:s})=>[e(h,{type:"primary",underline:!1},{default:n(()=>[m(oe(s.title),1)]),_:2},1024)]),_:1}),e(_,{label:"作者",prop:"createUser"}),e(_,{label:"发表时间",prop:"createTime"}),e(_,{label:"分类",prop:"type"}),e(_,{label:"标签",prop:"labelList.length"}),e(_,{label:"操作",width:"150"},{default:n(({row:s})=>[e(a,{icon:b(U),circle:"",plain:"",type:"primary",onClick:D=>A(s)},null,8,["icon","onClick"]),e(a,{type:"primary",circle:"",plain:"",onClick:D=>H(s)},{default:n(()=>[e(E,null,{default:n(()=>[e(J)]),_:1})]),_:2},1032,["onClick"]),e(a,{icon:b(q),circle:"",plain:"",type:"danger",onClick:D=>$(s)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),_:1})])]),o("div",Pe,[o("div",Ae,[e(W,{modelValue:T.value,"onUpdate:modelValue":t[4]||(t[4]=s=>T.value=s),style:{width:"240px"},placeholder:"Please input"},null,8,["modelValue"]),e(a,{type:"primary",onClick:v},{default:n(()=>[m("新增分类")]),_:1}),e(S,{data:b(y),style:{width:"100%"}},{empty:n(()=>[e(L,{description:"没有数据"})]),default:n(()=>[e(_,{label:"分类名",prop:"name"}),e(_,{label:"操作",width:"100"},{default:n(({row:s})=>[e(a,{icon:b(U),circle:"",plain:"",type:"primary",onClick:D=>Y(s)},null,8,["icon","onClick"]),e(a,{icon:b(q),circle:"",plain:"",type:"danger",onClick:D=>K(s)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])])]),o("div",Fe,[e(N,{height:"600px"},{default:n(()=>[e(pe)]),_:1})]),o("div",Me,[e(X,{class:"upload-demo",drag:"",action:"https://www.tbt-blog.cn/tbt/file/addFile",multiple:""},{tip:n(()=>[]),default:n(()=>[e(E,{class:"el-icon--upload"},{default:n(()=>[e(b(ie))]),_:1}),Ve]),_:1}),le(o("textarea",{placeholder:"说说内容","onUpdate:modelValue":t[5]||(t[5]=s=>se(g)?g.value=s:g=s)},null,512),[[ne,b(g)]]),e(a,{onClick:r},{default:n(()=>[m("添加")]),_:1})])])])])])}}});export{Le as default};
